"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.");}return(hint==="string"?String:Number)(input)}{const colors=['#f6f6f6','#f0f0f0','#e3e3e3','#d7d7d7','#d0d0d0'];let PageTurn=function(){function PageTurn(el,pagesTotal){_classCallCheck(this,PageTurn);this.DOM={el:el};this.config={duration:1.6,pagesDelay:0.15,ease:Quint.easeInOut};this.DOM.pagesWrap={left:this.DOM.el.querySelector('.revealer__item--left'),right:this.DOM.el.querySelector('.revealer__item--right')};let pagesHTML='';for(let i=0;i<=pagesTotal;++i){const color=colors[i]||colors[0];pagesHTML+=`<div class="revealer__item-inner"style="background-color:${color};"></div>`}this.DOM.pagesWrap.left.innerHTML=this.DOM.pagesWrap.right.innerHTML=pagesHTML;this.DOM.pages={left:Array.from(this.DOM.pagesWrap.left.querySelectorAll('.revealer__item-inner')),right:Array.from(this.DOM.pagesWrap.right.querySelectorAll('.revealer__item-inner'))}}_createClass(PageTurn,[{key:"addTween",value:function addTween(side,direction,nmbPages){const pages=this.DOM.pages[side];for(let i=0,len=nmbPages-1;i<=len;++i){const page=pages[i];this.tl.to(page,this.config.duration,{ease:this.config.ease,startAt:{x:direction==='next'?'100%':'-100%'},x:direction==='next'?'-100%':'100%'},i*this.config.pagesDelay)}}},{key:"createTweens",value:function createTweens(direction,nmbPages){this.addTween('left',direction,nmbPages);this.addTween('right',direction,nmbPages)}},{key:"turn",value:function turn(direction,nmbPages,middleAnimationCallback){var _this=this;return new Promise(function(resolve,reject){_this.tl=new TimelineMax({onComplete:resolve,paused:true});if(middleAnimationCallback){_this.tl.addCallback(middleAnimationCallback,(_this.config.duration+(nmbPages-1)*_this.config.pagesDelay)/2)}_this.createTweens(direction,nmbPages);_this.tl.resume()})}}]);return PageTurn}();let winsize;const calcWinsize=function(){return winsize={width:window.innerWidth,height:window.innerHeight}};calcWinsize();window.addEventListener('resize',calcWinsize);let Item=function(){function Item(el){var _this2=this;_classCallCheck(this,Item);this.DOM={el:el};this.DOM.inner=this.DOM.el.querySelector('.slide__figure-inner');this.DOM.image=this.DOM.inner.querySelector('.slide__figure-img');this.DOM.reveal=this.DOM.inner.querySelector('.slide__figure-reveal');this.DOM.title=this.DOM.el.querySelector('.slide__figure-title');this.DOM.description=this.DOM.el.querySelector('.slide__figure-description');const calcRect=function(){return _this2.rect=_this2.DOM.el.getBoundingClientRect()};window.addEventListener('resize',calcRect);calcRect()}_createClass(Item,[{key:"getSide",value:function getSide(){const center={x:this.rect.left+this.rect.width/2,y:this.rect.top+this.rect.height/2};return center.x>=winsize.width/2?'right':'left'}}]);return Item}();let Slide=function(){function Slide(el){var _this3=this;_classCallCheck(this,Slide);this.DOM={el:el};this.items=[];Array.from(this.DOM.el.querySelectorAll('.slide__figure')).forEach(function(item){return _this3.items.push(new Item(item))})}_createClass(Slide,[{key:"showItems",value:function showItems(direction){var _this4=this;return new Promise(function(resolve,reject){const duration=1;const ease=Expo.easeOut;_this4.tl=new TimelineMax({onComplete:resolve}).add('begin');for(const item of _this4.items){_this4.tl.to(item.DOM.el,duration,{ease:ease,startAt:{x:direction==='next'?60:-60,opacity:1},x:'0%'},'begin');if(direction==='next'&&item.getSide()==='left'||direction==='prev'&&item.getSide()==='right'){TweenMax.set(item.DOM.inner,{'transform-origin':direction==='next'?'100% 50%':'0% 50%'});_this4.tl.to(item.DOM.inner,duration,{ease:ease,startAt:{rotationY:direction==='next'?30:-30},rotationY:0.1},'begin')}_this4.tl.to(item.DOM.reveal,duration,{ease:ease,startAt:{x:'0%'},x:direction==='next'?'-100%':'100%'},'begin').to(item.DOM.image,duration,{ease:ease,startAt:{scale:1.5},scale:1},'begin').to(item.DOM.title,duration*0.8,{ease:Quart.easeOut,startAt:{x:direction==='next'?15:-15,opacity:0},x:'0%',opacity:1},'begin+=0.25').to(item.DOM.description,duration*0.8,{ease:Quart.easeOut,startAt:{x:direction==='next'?20:-20,opacity:0},x:'0%',opacity:1},'begin+=0.3')}})}},{key:"resetItems",value:function resetItems(){for(const item of this.items){TweenMax.set(item.DOM.el,{opacity:0});TweenMax.set([item.DOM.title,item.DOM.description],{opacity:0})}}}]);return Slide}();let Slideshow=function(){function Slideshow(el){var _this5=this;_classCallCheck(this,Slideshow);this.DOM={el:el};this.current=0;this.slides=[];Array.from(this.DOM.el.querySelectorAll('.slide')).forEach(function(slide){return _this5.slides.push(new Slide(slide))});this.slidesTotal=this.slides.length;this.slides[this.current].DOM.el.classList.add('slide--current');this.pageturn=new PageTurn(this.DOM.el.querySelector('.revealer'),this.slidesTotal);this.pagination={prevCtrl:this.DOM.el.querySelector('.arrow-nav__item--prev'),nextCtrl:this.DOM.el.querySelector('.arrow-nav__item--next')};this.DOM.nav=this.DOM.el.querySelector('.nav');this.DOM.navCtrl=this.DOM.nav.querySelector('.nav__button');this.DOM.tocItems=Array.from(this.DOM.nav.querySelectorAll('.toc > .toc__item'));this.DOM.tocItems[this.current].classList.add('toc__item--current');this.DOM.chapter=this.DOM.nav.querySelector('.nav__chapter');this.DOM.indicators=Array.from(this.DOM.el.querySelectorAll('.slideshow__indicator'));TweenMax.set(this.DOM.indicators[1],{scaleX:0});this.initEvents()}_createClass(Slideshow,[{key:"initEvents",value:function initEvents(){var _this6=this;const arrowClickPrevFn=function(){return _this6.pagethrough('prev')};const arrowClickNextFn=function(){return _this6.pagethrough('next')};this.pagination.prevCtrl.addEventListener('click',arrowClickPrevFn);this.pagination.nextCtrl.addEventListener('click',arrowClickNextFn);const navClickFn=function(){return _this6.toggleToc()};this.DOM.navCtrl.addEventListener('click',navClickFn);this.DOM.tocItems.forEach(function(tocItem,pos){tocItem.addEventListener('click',function(ev){ev.preventDefault();_this6.navigate(pos)})})}},{key:"switchPage",value:function switchPage(newPagePos,direction='next'){var _this7=this;const currentSlide=this.slides[this.current];const upcomingSlide=this.slides[newPagePos];currentSlide.DOM.el.classList.remove('slide--current');currentSlide.resetItems();upcomingSlide.DOM.el.style.zIndex=100;upcomingSlide.showItems(direction).then(function(){upcomingSlide.DOM.el.classList.add('slide--current');upcomingSlide.DOM.el.style.zIndex='';_this7.isAnimating=false});TweenMax.to(this.DOM.indicators[0],.5,{ease:Expo.easeOut,scaleX:1-newPagePos/(this.slidesTotal-1)});TweenMax.to(this.DOM.indicators[1],.5,{ease:Expo.easeOut,scaleX:newPagePos/(this.slidesTotal-1)});this.updateToc(newPagePos);this.current=newPagePos;this.pagination.nextCtrl.style.visibility=this.current===this.slidesTotal-1?'hidden':'visible';this.pagination.prevCtrl.style.visibility=this.current===0?'hidden':'visible'}},{key:"pagethrough",value:function pagethrough(direction){var _this8=this;if(this.isAnimating||direction==='next'&&this.current===this.slidesTotal-1||direction==='prev'&&this.current===0){return false}this.isAnimating=true;const newPagePos=direction==='next'?this.current+1:this.current-1;this.pageturn.turn(direction,1,function(){return _this8.switchPage(newPagePos,direction)})}},{key:"toggleToc",value:function toggleToc(){if(this.isTocOpen){this.DOM.chapter.style.opacity=1;this.DOM.nav.classList.remove('nav--open');TweenMax.set(this.DOM.tocItems,{opacity:0})}else{this.DOM.chapter.style.opacity=0;this.DOM.nav.classList.add('nav--open');TweenMax.staggerTo(this.DOM.tocItems,1,{ease:Expo.easeOut,startAt:{opacity:0,y:10},opacity:1,y:0},0.02)}this.isTocOpen=!this.isTocOpen}},{key:"updateToc",value:function updateToc(newpos){this.DOM.tocItems[this.current].classList.remove('toc__item--current');this.DOM.tocItems[newpos].classList.add('toc__item--current');this.DOM.chapter.innerHTML=this.DOM.tocItems[newpos].querySelector('.toc__item-title').innerHTML}},{key:"navigate",value:function navigate(newPagePos){var _this9=this;if(this.isAnimating||newPagePos===this.current){return false}this.isAnimating=true;this.toggleToc();const direction=newPagePos>this.current?'next':'prev';this.pageturn.turn(direction,Math.abs(this.current-newPagePos),function(){return _this9.switchPage(newPagePos,direction)})}}]);return Slideshow}();const slideshow=new Slideshow(document.querySelector('.slideshow'));imagesLoaded(document.querySelectorAll('.slide__figure-img'),{background:true},function(){return document.body.classList.remove('loading')})}